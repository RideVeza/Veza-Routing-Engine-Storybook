import{j as t}from"./jsx-runtime-CexXSJP5.js";import{r}from"./index-BP8_t0zE.js";import{i as q}from"./index-DhrrqPsw.js";import{d as T}from"./styled-components.browser.esm-Dx2qpfAi.js";import{g as z}from"./jobs-c2izYkBu.js";import{J as x}from"./jobs-DhiDD4xb.js";import{B as Y}from"./Button-DgKJQOcJ.js";import{C as G}from"./ContentHeader-BeoyYu9o.js";import{L as K}from"./List-Cksbtp4j.js";import{L as Q}from"./Loader-d7inWU2V.js";import{H as U}from"./Header-BuZqUXSu.js";import{J as y}from"./JobDetailsCards-DR4Pkfil.js";import{R as X}from"./RouteDetails-DKV8_c-V.js";import{k as J}from"./index-L2PmcK6x.js";import{t as C}from"./theme-DV-fQgRe.js";import{d as S,g as Z}from"./routes-Ss6aDr-t.js";import{F as tt}from"./Flex-DfchtKyW.js";import{T as et}from"./Title-NR0nO8_X.js";import{S as I}from"./Select-CgpR6YNG.js";import{f as ot,M as rt,g as st,h as it}from"./index-D317oxB0.js";import{n as at}from"./notifications.store-DxWvW9mD.js";import"./iconBase-tVazycLF.js";import"./httpClient-BlwsOI9O.js";import"./tslib.es6-Ytcc2UEA.js";import"./predicates-Dr2rkhIn.js";import"./Button-DQolzjlr.js";import"./default-theme-BUmQqxa3.js";import"./get-size-ZIjN6hcg.js";import"./factory-Cmy58O58.js";import"./create-vars-resolver-BkjTnGuP.js";import"./polymorphic-factory-DpGZ7QIF.js";import"./Loader-I3UIFO-P.js";import"./Transition-1eDnA5u2.js";import"./index-DJkmxc1E.js";import"./use-reduced-motion-BEzOJ-bM.js";import"./UnstyledButton-Bp_jImnG.js";import"./index-DUW3t7VM.js";import"./Skeleton-C45Pgd_S.js";import"./Group-uPXshQyq.js";import"./index-DWJGBGB2.js";import"./create-scoped-keydown-handler-C7O3t3U_.js";import"./get-contrast-color-CPKee8Lw.js";import"./get-auto-contrast-value-Da6zqqWm.js";import"./create-safe-context-DdvLfAHk.js";import"./DirectionProvider-DOfDrEPm.js";import"./use-id-B6kcI9zl.js";import"./use-isomorphic-effect-BPjV9wAK.js";import"./random-id-CCVmTau8.js";import"./use-uncontrolled-D1uLaDoI.js";import"./CloseButton-Bf40-Csk.js";import"./auth-h26ZURLX.js";import"./index-DDC2H7jq.js";import"./ActionIcon-g5D0V-R_.js";import"./ActionIcon-CaaKUvZ0.js";import"./CompanyCard-D7e2fVV_.js";import"./JobDetailsConfigurations-Dkkrz0gQ.js";import"./Card-D3lXULz8.js";import"./Paper-Coa4cW4M.js";import"./Switch-DEOlBtZP.js";import"./Input-2PvRR_UE.js";import"./JobDetailsRoutes-BbeCwuwQ.js";import"./index-B98Pt2jl.js";import"./Input-B6p2Evf3.js";import"./RouteCard-Dix3uWcG.js";import"./Badge-DqJ7v24Y.js";import"./JobDetailsSchools-Co_72Buj.js";import"./ScrollArea-D4tNmDXS.js";import"./use-merged-ref-DIizHiiB.js";import"./ObjectBadge-BW0P1RiL.js";import"./IconComponent-BLxFDGI_.js";import"./index-DDyY_0rn.js";import"./index-CYZFw_ar.js";import"./SelectInput-Cmdq-hxt.js";import"./SwitchComponent-Cs0CNOmW.js";import"./TextAreaInput-BfyWLCcP.js";import"./extends-CF3RwP-h.js";import"./objectWithoutPropertiesLoose-CAYKN5F1.js";import"./InputBase-Dxa36rRv.js";import"./date-pny-vRhT.js";import"./constructFrom-rJN6zrQ_.js";import"./DayShiftSelector-xfVhayJK.js";import"./WeekdaySelector-BDND3AmC.js";import"./ScheduleStepHeader-CxLKW8nK.js";import"./AccordionChevron-BAXzvIVP.js";import"./get-style-object-DUJZA7T_.js";import"./ContextWindowHeader-DOOOqHPz.js";import"./index-BB_o3gze.js";import"./IndicationsBadge-DCr2nWIo.js";import"./Image-CyM-z9cL.js";import"./use-form-yKeun-xg.js";import"./use-resolved-styles-api-9Hl1n5Yq.js";import"./Popover-2oXiTh42.js";import"./OptionalPortal-Dz0ZbQ5R.js";import"./use-floating-auto-update-DNpjfyuK.js";import"./FocusTrap-Qzhi2iHh.js";import"./is-element-CqW86lAY.js";const nt=T.div`
  width: 100%;
  height: 100%;

  display: flex;
  flex-direction: column;

  .job-details-content {
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .routes-map-section {
    display: grid;
    grid-template-columns: 4fr 8fr;
    grid-template-rows: auto;

    flex-grow: 1;
  }

  .list-component {
    flex-grow: 1;

    display: flex;
    flex-direction: column;
  }

  .job-details-content {
    flex-grow: 1;
  }

  .map-section {
    position: relative;
    height: 100%;
  }
`,lt=T.div`
  .selector-container {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 3;

    width: 390px;

    padding-right: 6px;

    background-color: white;
    border: 0.5px solid ${o=>o.theme.colors.gray[2]};
    border-radius: 12px;
  }

  .selector-title {
    white-space: nowrap;
  }

  .custom-select-section:last-child {
    border-left: 1px solid ${o=>o.theme.colors.gray[2]};
  }

  .selector-input {
    border: 1px solid ${o=>o.theme.colors.gray[2]};
    background-color: white;
  }
`,k=({onChange:o,isDisabled:e=!1})=>{const[d,i]=r.useState(S[0]),[c,m]=r.useState(x.AM),u=a=>{a&&(i(a),o({day:a,shift:c}))},b=a=>{a&&(m(a),o({day:d,shift:a}))};return t.jsx(lt,{theme:C,children:t.jsxs(tt,{gap:6,align:"center",className:"selector-container",children:[t.jsx(et,{order:5,c:C.colors.primary[6],p:"15px 6px",className:"selector-title",children:"Route Path"}),t.jsx(I,{defaultValue:d,radius:8,onChange:u,variant:"default",rightSection:t.jsx(J,{}),classNames:{section:"custom-select-section",input:"selector-input"},data:S,disabled:e}),t.jsx(I,{defaultValue:c,radius:8,onChange:b,variant:"default",rightSection:t.jsx(J,{}),classNames:{section:"custom-select-section",input:"selector-input"},data:[x.AM,x.PM],disabled:e})]})})};k.__docgenInfo={description:"",methods:[],displayName:"RouteSelector",props:{isDisabled:{defaultValue:{value:"false",computed:!1},required:!1}}};const j=()=>{const{id:o}=ot(),[e,d]=r.useState(),[i,c]=r.useState(),[m,u]=r.useState(!0),[b,a]=r.useState(!1),[R,O]=r.useState(S[0]),[D,E]=r.useState(x.AM),[f,H]=r.useState("Routes"),[p,h]=r.useState([]),[F,L]=r.useState([]),[w,P]=r.useState(null),M=()=>{console.log("Not implemented")},A=()=>{console.log("Not implemented")},_=()=>{console.log("Not implemented")};r.useEffect(()=>{(async()=>{try{if(!o)throw new Error("Job ID not defined");const n=await z(o),s=Z(n);d(s),u(!1)}catch{at.show({color:"red",title:"Failed to fetch job",message:"You will be redirected!"}),a(!0),u(!1),setTimeout(()=>{window.location.assign("/route-planner")},3e3)}})()},[o]);const V=({day:l,shift:n})=>{O(l),E(n)};r.useEffect(()=>{var n;if(!e)return;if(e.isOldJob)return c({...e,routes:[{dayOfTheWeek:"",formattedRouteStopsByDay:[]}]});const l={...e,routes:((n=e==null?void 0:e.routes)==null?void 0:n.filter(s=>s.dayOfTheWeek===R))??[]};c({...e,routes:[{dayOfTheWeek:l.routes[0].dayOfTheWeek,formattedRouteStopsByDay:l.routes[0].formattedRouteStopsByDay.filter(s=>s.shift===D)}]})},[e,R,D]),r.useEffect(()=>{if(p.length>0&&e){const l=p[0];L(e.routes.map(s=>({...s,formattedRouteStopsByDay:s.formattedRouteStopsByDay.filter($=>$.studentRouteId===l)})));const n=e.routesInfo.filter(s=>s.studentRouteId===l);P(n[0])}},[p,e]);const W=[{label:"Routes",content:t.jsx(y,{formattedJobData:i,isLoading:m,activeTab:f,setHighlightRoute:h})},{label:"Schools",content:t.jsx(y,{formattedJobData:i,isLoading:m,activeTab:f,setHighlightRoute:h})},{label:"Configurations",content:t.jsx(y,{formattedJobData:i,isLoading:m,activeTab:f,setHighlightRoute:h})}];return m||b?t.jsx(Q,{}):t.jsxs(nt,{children:[t.jsx(U,{leftText:"Route Planner"}),t.jsxs("div",{className:"job-details-content",children:[t.jsx(G,{primaryTitle:(i==null?void 0:i.jobName)??"Job Name",hasBorderBottom:!0,headerAlign:"center",onSecondaryClick:M,onPrimaryClick:A,primaryButtonVariant:"light",renderHeaderButtonComponent:()=>t.jsx(Y,{text:"Publish",variant:"filled",icon:q,isIconOnLeft:!0,onClick:_})}),t.jsxs("div",{className:"routes-map-section",children:[t.jsxs("div",{className:"list-component",children:[!p.length&&t.jsx(K,{tabs:W,setActiveTab:H,activeTab:f,borderRadius:"0 0 0 20px",hasBorderBottom:!1}),p.length>0&&w&&t.jsx(X,{routes:F,routeInfo:w,setHighlightRoute:h})]}),t.jsxs("div",{className:"map-section",children:[t.jsx("div",{style:{position:"relative"},children:t.jsx(k,{onChange:V,isDisabled:(e==null?void 0:e.isOldJob)||p.length>0})}),i&&t.jsx(t.Fragment,{})]})]})]})]})};j.__docgenInfo={description:"",methods:[],displayName:"JobDetails"};const Ue={title:"Pages/JobDetails",component:j,tags:["autodocs"],decorators:[o=>t.jsx(rt,{initialEntries:["/job/details/123"],children:t.jsx(st,{children:t.jsx(it,{path:"/job/details/:id",element:t.jsx(o,{})})})})],parameters:{layout:"fullscreen"}},g={render:o=>t.jsx(j,{...o})};var B,N,v;g.parameters={...g.parameters,docs:{...(B=g.parameters)==null?void 0:B.docs,source:{originalSource:`{
  render: args => <JobDetails {...args} />
}`,...(v=(N=g.parameters)==null?void 0:N.docs)==null?void 0:v.source}}};const Xe=["Default"];export{g as Default,Xe as __namedExportsOrder,Ue as default};
